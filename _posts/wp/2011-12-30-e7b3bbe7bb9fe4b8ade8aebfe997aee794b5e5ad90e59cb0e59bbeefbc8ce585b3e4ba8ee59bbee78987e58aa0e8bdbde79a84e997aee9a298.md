---
author: yangzy666
comments: true
date: 2011-12-30 13:29:00+00:00
layout: post
slug: '%e7%b3%bb%e7%bb%9f%e4%b8%ad%e8%ae%bf%e9%97%ae%e7%94%b5%e5%ad%90%e5%9c%b0%e5%9b%be%ef%bc%8c%e5%85%b3%e4%ba%8e%e5%9b%be%e7%89%87%e5%8a%a0%e8%bd%bd%e7%9a%84%e9%97%ae%e9%a2%98'
title: 系统中访问电子地图，关于图片加载的问题
wordpress_id: 239
categories:
- javascript
- 网络
---
{% include JB/setup %}

今天上班遇到电子地图中的标记物图标加载问题，用户反映难以忍受。因为每次查询站点数据时，展现在地图上的站点图标不能及时显示出来，而是每次都需要从服务器端抓取最新的图标，虽然图标较小，只有20多KB，但如果每次查询出来几十个甚至上百个站点，而这些站点又是使用的同一个图标，这样从服务器抓图标则也是一件比较浪费时间及网络带宽的事情，那么当站点一个个显示的时候，它的图标就会像冒泡一样一个个蹦出来，这样就出现了一个问题：很有可能某个站点的图标因为网络问题而一直被卡住始终显示不出来了，也就是说，地图上展现出来的站点数据是不完全整的了，那就会可用户带来极大的误导。最后，发现招商银行网站的网点搜索和mapabc网站上的搜索页面都不存在这种问题，用httpwatch查看发现，它们的网站在第一次查询数据时会从服务器加载图标，而且相同的图标只会加载一次，而我的系统里面相同的图标却要各自加载一次，这样就大大降低了系统的响应及展现速度。另外，这两个网站在第二次搜索时，不会再次加载前面已展现过的图标，而我的系统却不能。基于这两点，我感觉自己还有许多东西要摸索，人家的系统性能把握得相当好，速度很快，值得深入研究。今天最后，为了解决用户的问题，终于找到了一个临时解决方案，就是在浏览器中设置缓存，这样图标展现的时候就不会断断续续，而是瞬间一闪，几乎同时展现出来了，原理很简单，就是这些被查询出来过的图标被浏览器缓存起来了，下次再用就不需要向服务器发送请求来获取了，大大提高了响应速度。当然这只是临时解决方案，说不定哪天用户又把浏览器的设置给改了呢？呵，还得继续改，改成那两个网站一样的效果。。。
